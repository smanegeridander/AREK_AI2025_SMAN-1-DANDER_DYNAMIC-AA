<!doctype html>

<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pengingat Minum — Soft Coding</title>
  <style>
    :root{
      --bg:#f6fbff; --card:#ffffff; --accent:#0ea5a4; --muted:#6b7280; --danger:#ef4444;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,var(--bg),#eef7fb);min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px}
    .card{width:100%;max-width:820px;background:var(--card);border-radius:12px;box-shadow:0 6px 18px rgba(12,40,80,0.06);padding:22px;display:grid;grid-template-columns:1fr 320px;gap:18px}
    header{grid-column:1/-1;display:flex;align-items:center;justify-content:space-between}
    h1{margin:0;font-size:20px}
    p.lead{margin:6px 0 0;color:var(--muted);font-size:13px}/* Left column */
.controls{padding:12px}
.row{display:flex;gap:8px;align-items:center;margin-top:12px}
label{font-size:13px;color:var(--muted)}
input[type=number],select{width:140px;padding:8px;border:1px solid #e6eef5;border-radius:8px}
.btn{padding:10px 12px;border-radius:10px;border:0;background:var(--accent);color:white;cursor:pointer}
.btn.secondary{background:transparent;border:1px solid #e6eef5;color:var(--muted)}

.status{margin-top:18px;padding:14px;border-radius:10px;background:#fbfeff;border:1px solid #e6f6f6}
.big{font-size:36px;margin:6px 0}
.small{font-size:13px;color:var(--muted)}

/* Right column */
.panel{background:linear-gradient(180deg,#ffffff,#fbfdff);border-radius:10px;padding:12px;border:1px solid #eef6f9}
.list{display:flex;flex-direction:column;gap:8px;margin-top:10px}
.list .item{display:flex;justify-content:space-between;padding:8px;border-radius:8px;background:#fff;border:1px solid #f1f7fb}

footer{grid-column:1/-1;text-align:center;margin-top:12px;color:var(--muted);font-size:12px}

@media(max-width:820px){.card{grid-template-columns:1fr}.panel{order:2}}

  </style>
</head>
<body>
  <div class="card" role="application" aria-label="Aplikasi pengingat minum">
    <header>
      <div>
        <h1>Pengingat Minum</h1>
        <p class="lead">Aplikasi web sederhana untuk mengingatkan minum air secara berkala. Berjalan di browser, simpan pengaturan lokal.</p>
      </div>
      <div>
        <button id="notify-perm" class="btn secondary">Minta Izin Notifikasi</button>
      </div>
    </header><main class="controls" aria-live="polite">
  <label for="interval">Interval pengingat (menit)</label>
  <div class="row">
    <input id="interval" type="number" min="1" max="1440" value="60" aria-label="Interval dalam menit" />
    <select id="amount">
      <option value="200">200 ml</option>
      <option value="250" selected>250 ml</option>
      <option value="300">300 ml</option>
      <option value="500">500 ml</option>
    </select>
    <button id="start" class="btn">Mulai</button>
    <button id="stop" class="btn secondary">Berhenti</button>
  </div>

  <div class="row">
    <label for="sound">Suara pengingat</label>
    <select id="sound">
      <option value="ding">Ding</option>
      <option value="chime">Chime</option>
      <option value="none">Tanpa suara</option>
    </select>

    <label style="margin-left:16px"><input id="vibrate" type="checkbox"/> Getar (perangkat seluler)</label>
  </div>

  <div class="status">
    <div class="small">Status</div>
    <div id="running" class="big">Berhenti</div>
    <div class="small">Waktu menuju pengingat berikutnya</div>
    <div id="countdown" class="big">00:00:00</div>
    <div class="small">Total konsumsi hari ini: <span id="total">0</span> ml</div>
  </div>

  <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
    <button id="log-drink" class="btn secondary">Sudah minum (Catat)</button>
    <button id="reset-today" class="btn" style="background:var(--danger)">Reset hari ini</button>
    <button id="test-notif" class="btn secondary">Tes Notifikasi</button>
  </div>

</main>

<aside class="panel">
  <h3 style="margin:0">Riwayat singkat</h3>
  <div class="list" id="history">
    <!-- item -->
  </div>

  <div style="margin-top:12px">
    <label class="small">Target harian (ml)</label>
    <div class="row">
      <input id="target" type="number" value="2000" min="0" />
      <div style="flex:1;text-align:right" class="small">Progress: <span id="progress">0%</span></div>
    </div>
  </div>
</aside>

<footer>
  Dibuat dengan ❤️ — Soft coding HTML. Pengaturan disimpan di browser (localStorage).
</footer>

  </div><script>
// Simple Drink Reminder
// Fitur: interval pengingat, notifikasi browser, suara, catat konsumsi, simpan di localStorage

const $ = id=>document.getElementById(id);
const AUDIO_FILES = {
  ding: 'data:audio/mp3;base64,//uQxAAAAAAAAAAAAAAAAAAAA...'
  // NOTE: For production replace with real audio or fetch. Here left as placeholder.
}

let timer = null;
let endsAt = null;
let running = false;

// Load settings
function loadSettings(){
  const s = JSON.parse(localStorage.getItem('drink.reminder') || '{}');
  if(s.interval) $('interval').value = s.interval;
  if(s.amount) $('amount').value = s.amount;
  if(s.sound) $('sound').value = s.sound;
  if(typeof s.vibrate !== 'undefined') $('vibrate').checked = s.vibrate;
  if(s.target) $('target').value = s.target;
}

function saveSettings(){
  const s = {
    interval: Number($('interval').value),
    amount: Number($('amount').value),
    sound: $('sound').value,
    vibrate: $('vibrate').checked,
    target: Number($('target').value)
  }
  localStorage.setItem('drink.reminder', JSON.stringify(s));
}

// Persistence for today data
function getTodayKey(){
  const d = new Date();
  return 'drink.data.' + d.toISOString().slice(0,10);
}
function loadToday(){
  return JSON.parse(localStorage.getItem(getTodayKey()) || '[]');
}
function saveToday(arr){
  localStorage.setItem(getTodayKey(), JSON.stringify(arr));
}

function addLog(amount){
  const arr = loadToday();
  arr.unshift({ts:Date.now(), amount});
  saveToday(arr.slice(0,50));
  renderHistory();
}

function renderHistory(){
  const arr = loadToday();
  const hist = $('history'); hist.innerHTML='';
  let total = 0;
  arr.forEach(item=>{
    total += Number(item.amount);
    const d = new Date(item.ts);
    const el = document.createElement('div'); el.className='item';
    el.innerHTML = `<div>${item.amount} ml</div><div class="small">${d.toLocaleTimeString()}</div>`;
    hist.appendChild(el);
  });
  $('total').textContent = total;
  const target = Number($('target').value)||0;
  $('progress').textContent = target? Math.round(total/target*100) + '%' : '0%';
}

function requestNotificationPermission(){
  if(!('Notification' in window)){
    alert('Notifikasi tidak didukung di browser ini.');
    return;
  }
  Notification.requestPermission().then(p=>{
    alert('Status izin: ' + p);
  });
}

$('notify-perm').addEventListener('click', requestNotificationPermission);

function playSound(name){
  if(name === 'none') return;
  // simple beep using WebAudio (no external file needed)
  try{
    const ctx = new (window.AudioContext||window.webkitAudioContext)();
    const o = ctx.createOscillator();
    const g = ctx.createGain();
    o.type = 'sine';
    o.frequency.value = name==='chime'? 880 : 660;
    g.gain.value = 0.05;
    o.connect(g); g.connect(ctx.destination);
    o.start();
    setTimeout(()=>{o.stop(); ctx.close()}, 500);
  }catch(e){console.warn('Audio error',e)}
}

function vibrateIfNeeded(){
  if($('vibrate').checked && navigator.vibrate) navigator.vibrate([200,100,200]);
}

function notify(title, body){
  // Browser Notification
  if('Notification' in window && Notification.permission === 'granted'){
    try{ new Notification(title, {body}) }catch(e){console.warn(e)}
  }
  playSound($('sound').value);
  vibrateIfNeeded();
}

function startTimer(){
  saveSettings();
  const intervalMin = Number($('interval').value)||60;
  endsAt = Date.now() + intervalMin*60*1000;
  running = true; updateUI();
  if(timer) clearInterval(timer);
  timer = setInterval(()=>{
    const now = Date.now();
    if(now >= endsAt){
      // fire reminder
      notify('Waktunya minum!', `Minumlah ${$('amount').value} ml sekarang.`);
      addLog(Number($('amount').value));
      // schedule next
      endsAt = Date.now() + intervalMin*60*1000;
      renderHistory();
    }
    updateUI();
  }, 1000);
}

function stopTimer(){
  running = false; if(timer) clearInterval(timer); timer = null; endsAt = null; updateUI();
}

function updateUI(){
  $('running').textContent = running? 'Berjalan' : 'Berhenti';
  if(running && endsAt){
    const rem = Math.max(0, Math.round((endsAt - Date.now())/1000));
    const h = String(Math.floor(rem/3600)).padStart(2,'0');
    const m = String(Math.floor((rem%3600)/60)).padStart(2,'0');
    const s = String(rem%60).padStart(2,'0');
    $('countdown').textContent = `${h}:${m}:${s}`;
  } else {
    $('countdown').textContent = '00:00:00';
  }
}

// Buttons
$('start').addEventListener('click', ()=>{
  startTimer();
});
$('stop').addEventListener('click', ()=> stopTimer());
$('log-drink').addEventListener('click', ()=>{
  addLog(Number($('amount').value)); renderHistory();
});
$('reset-today').addEventListener('click', ()=>{
  if(confirm('Reset riwayat hari ini?')){ localStorage.removeItem(getTodayKey()); renderHistory(); }
});
$('test-notif').addEventListener('click', ()=>{
  notify('Tes pengingat', 'Ini adalah tes notifikasi.');
});

// Save when settings change
['interval','amount','sound','vibrate','target'].forEach(id=>{
  $(id).addEventListener('change', ()=>{ saveSettings(); renderHistory(); });
});

// On load
loadSettings(); renderHistory(); updateUI();

// Restore running state if page reload (optional simple approach)
window.addEventListener('beforeunload', ()=>{
  // don't auto-stop — we save settings and rely on user to restart
});

</script></body>
</html>